# vscode 的 webview 扩展调试能力

在开发 vscode 扩展的过程中，我们发现 debug 包含 webview 内容的扩展非常困难，因此塔尔旺科技花了很大精力，研发了一套 vscode 扩展的调试技术，可以让 vscode 的扩展开发速度提高2倍以上。

我们称这个技术为“高级vscode扩展开发技术”，简称 **“高级扩展DEBUG技术（ADET，Advanced Debug Extension Technology）”**，可以读作 [Adit]。

ADET 有以下特点：

1. **无需重启**：我们的调试技术可以在不重启 vscode 扩展的情况下，实现扩展中 webview 内容的自动热更新。有了 ADET，你在开发扩展时就能所见即所得地立即看见 webview 中 react 等前端代码的修改效果，非常地高效、易用。

2. **可视化调试前端代码**: 我们的调试技术可以让你在 vscode 中调试前端代码，可以充分利用 vscode 中 Chrome 浏览器的 Developer tools 窗口对webview前端代码进行样式和 JS 代码的调试。没有这个功能，开发扩展的 webview 前端代码将非常困难。

3. **开发模式、生成模式自动切换**: 有 ADET 的帮助，在打包发布扩展时，我们将无需手动修改代码，就可以实现将开发模式下使用的代码自动替换为生成模式的代码。例如代码中定义的 `IS_DEV` 变量，会根据是在开发模式还是生产模式，自动设置对应的值。这样可以实现“条件编译”的效果，也就是可以用开关变量控制不同模式下使用的最终代码。这个功能不但支持 JS、TSX、TS 等脚本文件，还支持 HTML 文件。

4. **开发模式样式与生产模式的样式一致**: 我们的调试技术可以让你在开发模式下，看到与生产模式一致的样式。因为 vscode 的 webview 内容需要继承来自 vscode 扩展的各种样式设定，包括主体等，ADET 就自动支持了这个功能。在开发模式下，你的 webview 前端代码也可以完美具备 vscode 的各种样式设置，包括 vscode 预置的各种 css 变量，如"
--vscode-foreground"等颜色值。

## ADET 使用方法

执行脚本 `npm run install:all` 安装依赖包。

执行脚本 `npm run watch` 编译、会自动编译变化的代码，除了扩展本身的代码热重载，该命令还会自动启动 webview 前端开发服务器，并支持前端热重载，所以整个扩展的代码热更新只需要执行这一个命令就可以了。

到这里就可以按 F5 Debug 扩展了。
